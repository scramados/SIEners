<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-styles/typography.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">

<dom-module id="my-studentRooster">
    <template>
        <style>
            :host {
                display: block;
            }

            span {
                @apply(--paper-font-body1);
            }
        </style>

        <h1 class="page-title">Overzicht van mijn vakken ( {{username}} )</h1>
        <table>
            <tr>
                <th>Vakcode</th>
                <th>Vaknaam</th>
            </tr>
            <template is="dom-repeat" items="{{lessen}}">
                <tr>
                    <td>{{item.datum}}</td>
                    <td>{{item.begintijd}}</td>
                    <td>{{item.eindtijd}}</td>
                    <td>{{item.lokaal}}</td>
                    <td>{{item.docent}}</td>
                    <td>{{item.klas}}</td>
                </tr>
            </template>
        </table>


        <iron-ajax
                id="ajax"
                method="POST"
                url="/student/mijnLessen"
                handle-as="json"
                on-response="responseHandler">
        </iron-ajax>

    </template>

    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'my-studentRooster',

                properties: {
                    username: String,
                    rol: {
                        observer: 'fetchRooster'
                    }
                },

                responseHandler: function (request) {
                    console.log(request.detail.response);
                    this.deLessen = request.detail.response;
                },

                fetchRooster: function () {
                    console.log("FetchRooster user=" + this.username);
                    if (this.rol == "student") {
                        this.$.ajax.contentType = "application/json";
                        this.$.ajax.body = {
                            "username": this.username
                        };
                        this.$.ajax.generateRequest();
                    }
                }

            });
        })();
    </script>
</dom-module>
